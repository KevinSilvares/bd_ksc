# PR0203: Uso del cliente HDFS (2)

### 1. Preparación el espacio de trabajo en HDFS

- Crea un directorio principal /proyectos/ecommerce en HDFS.
- Dentro de él, crea tres subdirectorios:
  - /raw → para los logs originales.
  - /procesados → para los logs ya tratados.
  - /backup → para copias de seguridad.

`hdfs dfs -mkdir -p /proyectos/ecommerce`

`hdfs dfs -mkdir /proyectos/ecommerce/raw`

`hdfs dfs -mkdir /proyectos/ecommerce/procesados`

`hdfs dfs -mkdir /proyectos/ecommerce/backup`

### 2. Carga inicial de logs
- Desde tu sistema local, sube al directorio /raw los siguientes logs de un servidor Web Apache:
    - Fichero de log 1
    - Fichero de log 2
    - Fichero de log 3

**Descarga**

`wget https://vgonzalez165.github.io/practicas_bigdata/practicas/bda/ut02/access_log_20251002-131938.log`

`wget https://vgonzalez165.github.io/practicas_bigdata/practicas/bda/ut02/access_log_20251002-131952.log`

`wget https://vgonzalez165.github.io/practicas_bigdata/practicas/bda/ut02/access_log_20251002-132005.log`

**Carga en HDFS**

`hdfs dfs -put access_log_* /proyectos/ecommerce/raw`

### 3. Inspección de datos
- Lista los archivos en /raw y visualiza su contenido.
- Muestra el número total de líneas en cada archivo subido.

`hdfs dfs -ls /proyetos/ecommerce/raw`
![alt text]({A50D4C08-F05F-4BAA-84F2-F24E9CB5C7BA}.png)

`hdfs dfs -head /proyectos/ecommerce/raw/access_log_20251002-131938.log`
![alt text]({F8239DFC-EF34-4DE7-8C73-9FF6F831D10C}.png)


### 4. Organización de los logs
- Copia los archivos de /raw a /backup.
- Mueve los archivos originales de /raw a /procesados.
  
`hdfs dfs -cp /proyectos/ecommerce/raw/* /proyectos/ecommerce/backup`
![alt text]({997EF278-B1C6-426E-8E10-BDDC4E95162C}.png)

`hdfs dfs -mv /proyectos/ecommerce/raw/* /proyectos/ecommerce/procesados`
![alt text]({51242F54-DCB0-4484-B43B-2E18D3490EAA}.png)
### 5. Acceso compartido para analistas
- Verifica los permisos actuales de /proyectos/ecommerce.
- Cambia los permisos de /procesados para que todos los usuarios tengan solo permisos de lectura, pero no de escritura ni eliminación.

`hdfs dfs -ls /proyecto/ecommerce`
![alt text]({AA1B6F68-4B90-40FE-93E8-60D0E19155DC}.png)

`hdfs dfs -chmod 444 /proyectos/ecommerce/*`
![alt text]({CD93BE68-897B-4CC9-8806-72C3C4B2514F}.png)

### 6. Simulación de trabajo con analistas
- Descarga desde HDFS uno de los archivos de /procesados a tu sistema local para compartirlo externamente.

`hdfs dfs -get /proyectos/ecommerce/procesados/access_log_20251002-132005.log`
![alt text]({A990AA96-F91B-4D47-9BE1-7DB4EE0F4363}.png)

### 7. Mantenimiento y limpieza
- Sube un archivo temporal al directorio /raw.
- Elimínalo de HDFS para mantener el espacio limpio.

`hdfs dfs -put access_log_20251002-132005.log /proyectos/ecommerce/raw`

`hdfs dfs -rm /proyectos/ecommerce/raw/access_log_20251002-132005.log`
![alt text]({A9931093-D788-4503-9FF1-8DD010575D76}.png)


### 8. (Opcional, avanzado)
- Configura una cuota de espacio en /backup (ejemplo: 10 MB).
- Intenta subir archivos hasta alcanzar el límite y observa el comportamiento del sistema.

[Volver](../index.md)